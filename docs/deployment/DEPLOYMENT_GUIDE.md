# ğŸš€ RingCentralå¤šæ™ºèƒ½ä½“ç³»ç»Ÿ - éƒ¨ç½²æŒ‡å—

## ğŸ“‹ **éƒ¨ç½²æ¶æ„æ¦‚è§ˆ**

### **æ„å»ºäº§ç‰©æµå‘å›¾**
```
æºä»£ç  â†’ æ„å»ºé˜¶æ®µ â†’ äº§ç‰©ç”Ÿæˆ â†’ éƒ¨ç½²ç›®æ ‡
   â†“         â†“         â†“         â†“
GitHub â†’ CI/CD â†’ Dockeré•œåƒ â†’ Kubernetesé›†ç¾¤
   â†“         â†“         â†“         â†“
  æ¨é€ â†’ GitHub Actions â†’ å®¹å™¨æ³¨å†Œè¡¨ â†’ ç”Ÿäº§ç¯å¢ƒ
```

## ğŸ—ï¸ **æ„å»ºäº§ç‰©è¯¦è§£**

### **1. JARæ–‡ä»¶äº§ç‰©**
| äº§ç‰©ç±»å‹ | ä½ç½® | ç”¨é€” |
|----------|------|------|
| **åº”ç”¨JAR** | `*/build/libs/*-1.0.0.jar` | å¯æ‰§è¡Œçš„Spring Bootåº”ç”¨ |
| **æºç JAR** | `*/build/libs/*-1.0.0-sources.jar` | æºä»£ç å½’æ¡£ |
| **æ–‡æ¡£JAR** | `*/build/libs/*-1.0.0-javadoc.jar` | APIæ–‡æ¡£å½’æ¡£ |

### **2. Dockeré•œåƒäº§ç‰©**
| æœåŠ¡åç§° | é•œåƒæ ‡ç­¾ | æ³¨å†Œè¡¨ä½ç½® |
|----------|----------|------------|
| **API Gateway** | `ringcentral/api-gateway:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |
| **Auth Service** | `ringcentral/auth-service:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |
| **Meeting Agent** | `ringcentral/meeting-agent:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |
| **Call Agent** | `ringcentral/call-agent:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |
| **Speech Engine** | `ringcentral/speech-engine:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |
| **NLU Engine** | `ringcentral/nlu-engine:${GITHUB_SHA}` | Docker Hub/ç§æœ‰æ³¨å†Œè¡¨ |

### **3. æµ‹è¯•æŠ¥å‘Šäº§ç‰©**
| æŠ¥å‘Šç±»å‹ | ä½ç½® | ç”¨é€” |
|----------|------|------|
| **å•å…ƒæµ‹è¯•æŠ¥å‘Š** | `*/build/reports/tests/` | ä»£ç è´¨é‡éªŒè¯ |
| **é›†æˆæµ‹è¯•æŠ¥å‘Š** | `tests/integration-tests/build/reports/` | æœåŠ¡é›†æˆéªŒè¯ |
| **E2Eæµ‹è¯•æŠ¥å‘Š** | `tests/e2e-tests/build/reports/` | ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯ |
| **æ€§èƒ½æµ‹è¯•æŠ¥å‘Š** | `tests/performance-tests/build/reports/` | æ€§èƒ½åŸºå‡†éªŒè¯ |
| **ä»£ç è¦†ç›–ç‡æŠ¥å‘Š** | `*/build/reports/jacoco/` | æµ‹è¯•è¦†ç›–ç‡åˆ†æ |

## ğŸ¯ **è‡ªåŠ¨éƒ¨ç½²æµç¨‹**

### **è§¦å‘æ¡ä»¶**
| åˆ†æ”¯ | è§¦å‘æ¡ä»¶ | éƒ¨ç½²ç›®æ ‡ | è‡ªåŠ¨åŒ–ç¨‹åº¦ |
|------|----------|----------|------------|
| **develop** | æ¨é€ä»£ç  | å¼€å‘ç¯å¢ƒ | **100%è‡ªåŠ¨** |
| **main** | æ¨é€ä»£ç  | ç”Ÿäº§ç¯å¢ƒ | **éœ€è¦å®¡æ‰¹** |
| **feature/** | PRåˆ›å»º | æ— éƒ¨ç½² | ä»…æ„å»ºæµ‹è¯• |

### **éƒ¨ç½²æµæ°´çº¿**
```mermaid
graph LR
    A[ä»£ç æ¨é€] --> B[æ„å»ºé•œåƒ]
    B --> C[æ¨é€æ³¨å†Œè¡¨]
    C --> D[éƒ¨ç½²åˆ°K8s]
    D --> E[å¥åº·æ£€æŸ¥]
    E --> F[é€šçŸ¥å®Œæˆ]
    
    style A fill:#e1f5fe
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style E fill:#fff8e1
    style F fill:#e0f2f1
```

## ğŸŒ **éƒ¨ç½²ç›®æ ‡ç¯å¢ƒ**

### **å¼€å‘ç¯å¢ƒ (Development)**
- **å‘½åç©ºé—´**: `ringcentral-dev`
- **åŸŸå**: `dev-api.ringcentral.com`
- **å‰¯æœ¬æ•°**: 1-2ä¸ªå‰¯æœ¬
- **èµ„æºé…ç½®**: åŸºç¡€é…ç½®
- **æ•°æ®åº“**: PostgreSQLå•å®ä¾‹
- **ç¼“å­˜**: Rediså•å®ä¾‹
- **è‡ªåŠ¨éƒ¨ç½²**: âœ… developåˆ†æ”¯æ¨é€æ—¶

### **ç”Ÿäº§ç¯å¢ƒ (Production)**
- **å‘½åç©ºé—´**: `ringcentral-prod`
- **åŸŸå**: `api.ringcentral.prod`
- **å‰¯æœ¬æ•°**: 3-20ä¸ªå‰¯æœ¬(è‡ªåŠ¨æ‰©ç¼©å®¹)
- **èµ„æºé…ç½®**: é«˜æ€§èƒ½é…ç½®
- **æ•°æ®åº“**: PostgreSQLé›†ç¾¤(3å‰¯æœ¬)
- **ç¼“å­˜**: Redisé›†ç¾¤(3å‰¯æœ¬)
- **è‡ªåŠ¨éƒ¨ç½²**: âš ï¸ mainåˆ†æ”¯æ¨é€æ—¶(éœ€è¦å®¡æ‰¹)

## ğŸ”§ **éƒ¨ç½²é…ç½®è¯¦è§£**

### **Kubernetesèµ„æºé…ç½®**

#### **å¼€å‘ç¯å¢ƒèµ„æº**
```yaml
resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "1Gi"
    cpu: "500m"
```

#### **ç”Ÿäº§ç¯å¢ƒèµ„æº**
```yaml
resources:
  requests:
    memory: "2Gi"
    cpu: "1000m"
  limits:
    memory: "4Gi"
    cpu: "2000m"
```

### **é«˜å¯ç”¨é…ç½®**

#### **API Gateway (ç”Ÿäº§ç¯å¢ƒ)**
- **å‰¯æœ¬æ•°**: 5ä¸ªåŸºç¡€å‰¯æœ¬
- **è‡ªåŠ¨æ‰©ç¼©å®¹**: 5-20ä¸ªå‰¯æœ¬
- **æ‰©å®¹æŒ‡æ ‡**: CPU 70%, å†…å­˜ 80%
- **æ»šåŠ¨æ›´æ–°**: æœ€å¤§å¢åŠ 2ä¸ªï¼Œæœ€å¤§ä¸å¯ç”¨1ä¸ª

#### **æ•°æ®åº“é›†ç¾¤**
- **PostgreSQL**: 3å‰¯æœ¬StatefulSet
- **Redis**: 3å‰¯æœ¬é›†ç¾¤æ¨¡å¼
- **æŒä¹…åŒ–å­˜å‚¨**: 100GB(PostgreSQL), 50GB(Redis)

## ğŸ” **éƒ¨ç½²éªŒè¯**

### **è‡ªåŠ¨å¥åº·æ£€æŸ¥**
```bash
# æ£€æŸ¥PodçŠ¶æ€
kubectl get pods -n ringcentral-prod

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
kubectl get services -n ringcentral-prod

# æ£€æŸ¥IngressçŠ¶æ€
kubectl get ingress -n ringcentral-prod
```

### **åº”ç”¨å¥åº·æ£€æŸ¥**
- **å­˜æ´»æ¢é’ˆ**: `/actuator/health` (60såå¼€å§‹ï¼Œ30sé—´éš”)
- **å°±ç»ªæ¢é’ˆ**: `/actuator/health/readiness` (30såå¼€å§‹ï¼Œ10sé—´éš”)

## ğŸ“Š **éƒ¨ç½²ç›‘æ§**

### **å…³é”®æŒ‡æ ‡**
| æŒ‡æ ‡ | é˜ˆå€¼ | å‘Šè­¦ |
|------|------|------|
| **Podå¯ç”¨æ€§** | < 80% | ç«‹å³å‘Šè­¦ |
| **å“åº”æ—¶é—´** | > 2ç§’ | è­¦å‘Š |
| **é”™è¯¯ç‡** | > 5% | ç«‹å³å‘Šè­¦ |
| **CPUä½¿ç”¨ç‡** | > 80% | è­¦å‘Š |
| **å†…å­˜ä½¿ç”¨ç‡** | > 85% | è­¦å‘Š |

### **éƒ¨ç½²é€šçŸ¥**
- **æˆåŠŸéƒ¨ç½²**: Slack/é‚®ä»¶é€šçŸ¥
- **éƒ¨ç½²å¤±è´¥**: ç«‹å³å‘Šè­¦
- **å›æ»šè§¦å‘**: è‡ªåŠ¨é€šçŸ¥

## ğŸ”„ **å›æ»šç­–ç•¥**

### **è‡ªåŠ¨å›æ»šæ¡ä»¶**
- å¥åº·æ£€æŸ¥å¤±è´¥è¶…è¿‡5åˆ†é’Ÿ
- é”™è¯¯ç‡è¶…è¿‡10%
- æœåŠ¡ä¸å¯ç”¨è¶…è¿‡3åˆ†é’Ÿ

### **æ‰‹åŠ¨å›æ»šå‘½ä»¤**
```bash
# å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬
kubectl rollout undo deployment/api-gateway -n ringcentral-prod

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
kubectl rollout undo deployment/api-gateway --to-revision=2 -n ringcentral-prod
```

## ğŸ” **å®‰å…¨é…ç½®**

### **å¯†é’¥ç®¡ç†**
- **æ•°æ®åº“å¯†ç **: Kubernetes Secret
- **APIå¯†é’¥**: ç¯å¢ƒå˜é‡æ³¨å…¥
- **TLSè¯ä¹¦**: cert-managerè‡ªåŠ¨ç®¡ç†

### **ç½‘ç»œå®‰å…¨**
- **Ingress**: NGINX + SSLç»ˆæ­¢
- **å†…éƒ¨é€šä¿¡**: Service Mesh(å¯é€‰)
- **ç½‘ç»œç­–ç•¥**: Podé—´è®¿é—®æ§åˆ¶

## ğŸ“‹ **éƒ¨ç½²æ£€æŸ¥æ¸…å•**

### **éƒ¨ç½²å‰æ£€æŸ¥**
- [ ] ä»£ç å·²é€šè¿‡æ‰€æœ‰æµ‹è¯•
- [ ] Dockeré•œåƒæ„å»ºæˆåŠŸ
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬å‡†å¤‡
- [ ] é…ç½®æ–‡ä»¶æ›´æ–°
- [ ] ç›‘æ§å‘Šè­¦é…ç½®

### **éƒ¨ç½²åéªŒè¯**
- [ ] æ‰€æœ‰Podè¿è¡Œæ­£å¸¸
- [ ] æœåŠ¡å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] APIæ¥å£å“åº”æ­£å¸¸
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] ç¼“å­˜æœåŠ¡æ­£å¸¸
- [ ] ç›‘æ§æŒ‡æ ‡æ­£å¸¸

## ğŸš¨ **æ•…éšœæ’é™¤**

### **å¸¸è§é—®é¢˜**
1. **Podå¯åŠ¨å¤±è´¥**: æ£€æŸ¥èµ„æºé™åˆ¶å’Œé•œåƒæ‹‰å–
2. **æœåŠ¡ä¸å¯è¾¾**: æ£€æŸ¥Serviceå’ŒIngressé…ç½®
3. **æ•°æ®åº“è¿æ¥å¤±è´¥**: æ£€æŸ¥å¯†é’¥å’Œç½‘ç»œç­–ç•¥
4. **å†…å­˜æº¢å‡º**: è°ƒæ•´JVMå‚æ•°å’Œèµ„æºé™åˆ¶

### **æ—¥å¿—æŸ¥çœ‹**
```bash
# æŸ¥çœ‹Podæ—¥å¿—
kubectl logs -f deployment/api-gateway -n ringcentral-prod

# æŸ¥çœ‹äº‹ä»¶
kubectl get events -n ringcentral-prod --sort-by='.lastTimestamp'
```

## ğŸ“ **æ”¯æŒè”ç³»**

- **DevOpså›¢é˜Ÿ**: devops@ringcentral.com
- **ç´§æ€¥è”ç³»**: +1-xxx-xxx-xxxx
- **ç›‘æ§é¢æ¿**: https://monitoring.ringcentral.com
- **æ—¥å¿—å¹³å°**: https://logs.ringcentral.com

---

**æœ€åæ›´æ–°**: 2024å¹´12æœˆ
**ç‰ˆæœ¬**: v2.0
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª 